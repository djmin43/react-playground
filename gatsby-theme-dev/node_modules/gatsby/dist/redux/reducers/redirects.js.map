{"version":3,"file":"redirects.js","names":["redirects","Map","exists","newRedirect","fromPathRedirects","get","fromPath","some","redirect","add","samePathRedirects","set","push","redirectsReducer","state","action","type","payload"],"sources":["../../../src/redux/reducers/redirects.ts"],"sourcesContent":["import _ from \"lodash\"\nimport { IGatsbyState, IRedirect, ICreateRedirectAction } from \"../types\"\n\nconst redirects = new Map<string, Array<IRedirect>>()\n\nfunction exists(newRedirect: IRedirect): boolean {\n  const fromPathRedirects = redirects.get(newRedirect.fromPath)\n\n  if (!fromPathRedirects) return false\n\n  return fromPathRedirects.some(redirect => _.isEqual(redirect, newRedirect))\n}\n\nfunction add(redirect: IRedirect): void {\n  let samePathRedirects = redirects.get(redirect.fromPath)\n\n  if (!samePathRedirects) {\n    samePathRedirects = []\n    redirects.set(redirect.fromPath, samePathRedirects)\n  }\n\n  samePathRedirects.push(redirect)\n}\n\nexport const redirectsReducer = (\n  state: IGatsbyState[\"redirects\"] = [],\n  action: ICreateRedirectAction\n): IGatsbyState[\"redirects\"] => {\n  switch (action.type) {\n    case `CREATE_REDIRECT`: {\n      const redirect = action.payload\n\n      // Add redirect only if it wasn't yet added to prevent duplicates\n      if (!exists(redirect)) {\n        add(redirect)\n\n        state.push(redirect)\n      }\n\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"mappings":";;;;;;;;;AAGA,MAAMA,SAAS,GAAG,IAAIC,GAAJ,EAAlB;;AAEA,SAASC,MAAT,CAAgBC,WAAhB,EAAiD;EAC/C,MAAMC,iBAAiB,GAAGJ,SAAS,CAACK,GAAV,CAAcF,WAAW,CAACG,QAA1B,CAA1B;EAEA,IAAI,CAACF,iBAAL,EAAwB,OAAO,KAAP;EAExB,OAAOA,iBAAiB,CAACG,IAAlB,CAAuBC,QAAQ,IAAI,uBAAUA,QAAV,EAAoBL,WAApB,CAAnC,CAAP;AACD;;AAED,SAASM,GAAT,CAAaD,QAAb,EAAwC;EACtC,IAAIE,iBAAiB,GAAGV,SAAS,CAACK,GAAV,CAAcG,QAAQ,CAACF,QAAvB,CAAxB;;EAEA,IAAI,CAACI,iBAAL,EAAwB;IACtBA,iBAAiB,GAAG,EAApB;IACAV,SAAS,CAACW,GAAV,CAAcH,QAAQ,CAACF,QAAvB,EAAiCI,iBAAjC;EACD;;EAEDA,iBAAiB,CAACE,IAAlB,CAAuBJ,QAAvB;AACD;;AAEM,MAAMK,gBAAgB,GAAG,CAC9BC,KAAgC,GAAG,EADL,EAE9BC,MAF8B,KAGA;EAC9B,QAAQA,MAAM,CAACC,IAAf;IACE,KAAM,iBAAN;MAAwB;QACtB,MAAMR,QAAQ,GAAGO,MAAM,CAACE,OAAxB,CADsB,CAGtB;;QACA,IAAI,CAACf,MAAM,CAACM,QAAD,CAAX,EAAuB;UACrBC,GAAG,CAACD,QAAD,CAAH;UAEAM,KAAK,CAACF,IAAN,CAAWJ,QAAX;QACD;;QAED,OAAOM,KAAP;MACD;;IAED;MACE,OAAOA,KAAP;EAfJ;AAiBD,CArBM"}