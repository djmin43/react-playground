{"version":3,"file":"babelrc.js","names":["babelrcReducer","state","stages","develop","plugins","presets","options","cacheDirectory","sourceType","action","type","Object","keys","forEach","stage","payload","index","plugin","name"],"sources":["../../../src/redux/reducers/babelrc.ts"],"sourcesContent":["import _ from \"lodash\"\n\nimport { IGatsbyState, ActionsUnion, IPlugin } from \"../types\"\n\nexport const babelrcReducer = (\n  state: IGatsbyState[\"babelrc\"] = {\n    stages: {\n      develop: {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"develop-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-javascript\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n    },\n  },\n  action: ActionsUnion\n): IGatsbyState[\"babelrc\"] => {\n  switch (action.type) {\n    case `SET_BABEL_PLUGIN`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].plugins,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].plugins[index]\n          state.stages[stage].plugins[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].plugins = [\n            ...state.stages[stage].plugins,\n            action.payload,\n          ]\n        }\n      })\n\n      return state\n    }\n    case `SET_BABEL_PRESET`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].presets,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].presets[index]\n          state.stages[stage].presets[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].presets = [\n            ...state.stages[stage].presets,\n            action.payload,\n          ]\n        }\n      })\n      return state\n    }\n    case `SET_BABEL_OPTIONS`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        state.stages[stage].options = {\n          ...state.stages[stage].options,\n          ...action.payload.options,\n        }\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"mappings":"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"}