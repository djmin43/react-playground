{"version":3,"file":"clean.js","names":["module","exports","clean","program","directory","report","directories","findCacheDir","name","filter","Boolean","info","join","Promise","all","map","dir","fs","remove","path","userGetsSevenDayFeedback","showSevenDayFeedbackRequest","userPassesFeedbackRequestHeuristic","showFeedbackRequest"],"sources":["../../src/commands/clean.ts"],"sourcesContent":["import fs from \"fs-extra\"\nimport path from \"path\"\nimport findCacheDir from \"find-cache-dir\"\n\nimport {\n  userGetsSevenDayFeedback,\n  userPassesFeedbackRequestHeuristic,\n  showFeedbackRequest,\n  showSevenDayFeedbackRequest,\n} from \"../utils/feedback\"\nimport { IProgram } from \"./types\"\n\nmodule.exports = async function clean(program: IProgram): Promise<void> {\n  const { directory, report } = program\n\n  const directories = [\n    `.cache`,\n    `public`,\n    // Ensure we clean babel loader cache\n    findCacheDir({\n      name: `babel-loader`,\n    }),\n    findCacheDir({\n      name: `terser-webpack-plugin`,\n    }),\n  ].filter(Boolean)\n\n  report.info(`Deleting ${directories.join(`, `)}`)\n\n  await Promise.all(\n    directories.map(dir => fs.remove(path.join(directory, dir)))\n  )\n\n  report.info(`Successfully deleted directories`)\n\n  if (await userGetsSevenDayFeedback()) {\n    showSevenDayFeedbackRequest()\n  } else if (await userPassesFeedbackRequestHeuristic()) {\n    showFeedbackRequest()\n  }\n}\n"],"mappings":";;;;AAAA;;AACA;;AACA;;AAEA;;AAQAA,MAAM,CAACC,OAAP,GAAiB,eAAeC,KAAf,CAAqBC,OAArB,EAAuD;EACtE,MAAM;IAAEC,SAAF;IAAaC;EAAb,IAAwBF,OAA9B;EAEA,MAAMG,WAAW,GAAG,CACjB,QADiB,EAEjB,QAFiB,EAGlB;EACA,IAAAC,qBAAA,EAAa;IACXC,IAAI,EAAG;EADI,CAAb,CAJkB,EAOlB,IAAAD,qBAAA,EAAa;IACXC,IAAI,EAAG;EADI,CAAb,CAPkB,EAUlBC,MAVkB,CAUXC,OAVW,CAApB;EAYAL,MAAM,CAACM,IAAP,CAAa,YAAWL,WAAW,CAACM,IAAZ,CAAkB,IAAlB,CAAuB,EAA/C;EAEA,MAAMC,OAAO,CAACC,GAAR,CACJR,WAAW,CAACS,GAAZ,CAAgBC,GAAG,IAAIC,gBAAA,CAAGC,MAAH,CAAUC,aAAA,CAAKP,IAAL,CAAUR,SAAV,EAAqBY,GAArB,CAAV,CAAvB,CADI,CAAN;EAIAX,MAAM,CAACM,IAAP,CAAa,kCAAb;;EAEA,IAAI,MAAM,IAAAS,kCAAA,GAAV,EAAsC;IACpC,IAAAC,qCAAA;EACD,CAFD,MAEO,IAAI,MAAM,IAAAC,4CAAA,GAAV,EAAgD;IACrD,IAAAC,6BAAA;EACD;AACF,CA5BD"}