{"version":3,"file":"repl.js","names":["module","exports","program","trackCli","bootstrap","schema","config","babelrc","pages","components","staticQueryComponents","store","getState","nodes","getNodes","query","result","graphql","console","log","JSON","stringify","_","repl","start","prompt","context","getNode","getNodesByType","loadNodeContent","entries","siteConfig","staticQueries","on","process","exit"],"sources":["../../src/commands/repl.ts"],"sourcesContent":["import repl from \"repl\"\nimport { graphql } from \"graphql\"\nimport { bootstrap } from \"../bootstrap\"\nimport { trackCli } from \"gatsby-telemetry\"\nimport { getNodes, getNode, getNodesByType } from \"../datastore\"\nimport { loadNodeContent } from \"../utils/nodes\"\nimport { store } from \"../redux\"\nimport { IProgram } from \"./types\"\n\nmodule.exports = async (program: IProgram): Promise<void> => {\n  trackCli(`REPL_START`)\n  // run bootstrap\n  await bootstrap({ program })\n\n  // get all the goodies from the store\n  const { schema, config, babelrc, pages, components, staticQueryComponents } =\n    store.getState()\n\n  const nodes = getNodes()\n\n  const query = async (query: string): Promise<void> => {\n    const result = await graphql(schema, query, {}, {}, {})\n    console.log(`query result: ${JSON.stringify(result)}`)\n  }\n\n  // init new repl\n  const _ = repl.start({\n    prompt: `gatsby > `,\n  })\n\n  // set some globals to make life easier\n  _.context.babelrc = babelrc\n  _.context.components = components\n  _.context.getNode = getNode\n  _.context.getNodes = getNodes\n  _.context.getNodesByType = getNodesByType\n  _.context.loadNodeContent = loadNodeContent\n  _.context.nodes = [...nodes.entries()]\n  _.context.pages = [...pages.entries()]\n  _.context.graphql = query\n  _.context.schema = schema\n  _.context.siteConfig = config\n  _.context.staticQueries = staticQueryComponents\n\n  _.on(`exit`, () => {\n    trackCli(`REPL_STOP`)\n    process.exit(0)\n  })\n}\n"],"mappings":";;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGAA,MAAM,CAACC,OAAP,GAAiB,MAAOC,OAAP,IAA4C;EAC3D,IAAAC,yBAAA,EAAU,YAAV,EAD2D,CAE3D;;EACA,MAAM,IAAAC,oBAAA,EAAU;IAAEF;EAAF,CAAV,CAAN,CAH2D,CAK3D;;EACA,MAAM;IAAEG,MAAF;IAAUC,MAAV;IAAkBC,OAAlB;IAA2BC,KAA3B;IAAkCC,UAAlC;IAA8CC;EAA9C,IACJC,YAAA,CAAMC,QAAN,EADF;;EAGA,MAAMC,KAAK,GAAG,IAAAC,mBAAA,GAAd;;EAEA,MAAMC,KAAK,GAAG,MAAOA,KAAP,IAAwC;IACpD,MAAMC,MAAM,GAAG,MAAM,IAAAC,gBAAA,EAAQZ,MAAR,EAAgBU,KAAhB,EAAuB,EAAvB,EAA2B,EAA3B,EAA+B,EAA/B,CAArB;IACAG,OAAO,CAACC,GAAR,CAAa,iBAAgBC,IAAI,CAACC,SAAL,CAAeL,MAAf,CAAuB,EAApD;EACD,CAHD,CAX2D,CAgB3D;;;EACA,MAAMM,CAAC,GAAGC,aAAA,CAAKC,KAAL,CAAW;IACnBC,MAAM,EAAG;EADU,CAAX,CAAV,CAjB2D,CAqB3D;;;EACAH,CAAC,CAACI,OAAF,CAAUnB,OAAV,GAAoBA,OAApB;EACAe,CAAC,CAACI,OAAF,CAAUjB,UAAV,GAAuBA,UAAvB;EACAa,CAAC,CAACI,OAAF,CAAUC,OAAV,GAAoBA,kBAApB;EACAL,CAAC,CAACI,OAAF,CAAUZ,QAAV,GAAqBA,mBAArB;EACAQ,CAAC,CAACI,OAAF,CAAUE,cAAV,GAA2BA,yBAA3B;EACAN,CAAC,CAACI,OAAF,CAAUG,eAAV,GAA4BA,sBAA5B;EACAP,CAAC,CAACI,OAAF,CAAUb,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACiB,OAAN,EAAJ,CAAlB;EACAR,CAAC,CAACI,OAAF,CAAUlB,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACsB,OAAN,EAAJ,CAAlB;EACAR,CAAC,CAACI,OAAF,CAAUT,OAAV,GAAoBF,KAApB;EACAO,CAAC,CAACI,OAAF,CAAUrB,MAAV,GAAmBA,MAAnB;EACAiB,CAAC,CAACI,OAAF,CAAUK,UAAV,GAAuBzB,MAAvB;EACAgB,CAAC,CAACI,OAAF,CAAUM,aAAV,GAA0BtB,qBAA1B;;EAEAY,CAAC,CAACW,EAAF,CAAM,MAAN,EAAa,MAAM;IACjB,IAAA9B,yBAAA,EAAU,WAAV;IACA+B,OAAO,CAACC,IAAR,CAAa,CAAb;EACD,CAHD;AAID,CAvCD"}