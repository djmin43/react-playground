{"version":3,"file":"run-static-queries.js","names":["runStaticQueries","parentSpan","queryIds","store","program","graphqlRunner","assertStore","staticQueryIds","length","state","getState","activity","reporter","createProgress","id","process","env","GATSBY_EXPERIMENTAL_PARALLEL_QUERY_RUNNING","start","processStaticQueries","graphqlTracing","done"],"sources":["../../src/services/run-static-queries.ts"],"sourcesContent":["import { processStaticQueries } from \"../query\"\nimport reporter from \"gatsby-cli/lib/reporter\"\nimport { IQueryRunningContext } from \"../state-machines/query-running/types\"\nimport { assertStore } from \"../utils/assert-store\"\n\nexport async function runStaticQueries({\n  parentSpan,\n  queryIds,\n  store,\n  program,\n  graphqlRunner,\n}: Partial<IQueryRunningContext>): Promise<void> {\n  assertStore(store)\n\n  if (!queryIds) {\n    return\n  }\n  const { staticQueryIds } = queryIds\n  if (!staticQueryIds.length) {\n    return\n  }\n\n  const state = store.getState()\n  const activity = reporter.createProgress(\n    `run static queries`,\n    staticQueryIds.length,\n    0,\n    {\n      id: `static-query-running`,\n      parentSpan,\n    }\n  )\n\n  // TODO: This is hacky, remove with a refactor of PQR itself\n  if (!process.env.GATSBY_EXPERIMENTAL_PARALLEL_QUERY_RUNNING) {\n    activity.start()\n  }\n\n  await processStaticQueries(staticQueryIds, {\n    state,\n    activity,\n    graphqlRunner,\n    graphqlTracing: program?.graphqlTracing,\n  })\n\n  if (!process.env.GATSBY_EXPERIMENTAL_PARALLEL_QUERY_RUNNING) {\n    activity.done()\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AAEO,eAAeA,gBAAf,CAAgC;EACrCC,UADqC;EAErCC,QAFqC;EAGrCC,KAHqC;EAIrCC,OAJqC;EAKrCC;AALqC,CAAhC,EAM0C;EAC/C,IAAAC,wBAAA,EAAYH,KAAZ;;EAEA,IAAI,CAACD,QAAL,EAAe;IACb;EACD;;EACD,MAAM;IAAEK;EAAF,IAAqBL,QAA3B;;EACA,IAAI,CAACK,cAAc,CAACC,MAApB,EAA4B;IAC1B;EACD;;EAED,MAAMC,KAAK,GAAGN,KAAK,CAACO,QAAN,EAAd;;EACA,MAAMC,QAAQ,GAAGC,iBAAA,CAASC,cAAT,CACd,oBADc,EAEfN,cAAc,CAACC,MAFA,EAGf,CAHe,EAIf;IACEM,EAAE,EAAG,sBADP;IAEEb;EAFF,CAJe,CAAjB,CAZ+C,CAsB/C;;;EACA,IAAI,CAACc,OAAO,CAACC,GAAR,CAAYC,0CAAjB,EAA6D;IAC3DN,QAAQ,CAACO,KAAT;EACD;;EAED,MAAM,IAAAC,2BAAA,EAAqBZ,cAArB,EAAqC;IACzCE,KADyC;IAEzCE,QAFyC;IAGzCN,aAHyC;IAIzCe,cAAc,EAAEhB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEgB;EAJgB,CAArC,CAAN;;EAOA,IAAI,CAACL,OAAO,CAACC,GAAR,CAAYC,0CAAjB,EAA6D;IAC3DN,QAAQ,CAACU,IAAT;EACD;AACF"}