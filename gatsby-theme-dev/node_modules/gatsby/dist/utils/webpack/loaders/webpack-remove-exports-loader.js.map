{"version":3,"file":"webpack-remove-exports-loader.js","names":["webpackRemoveExportsLoader","source","sourceMap","callback","async","options","getOptions","transform","babelrc","configFile","inputSourceMap","undefined","sourceFileName","resourcePath","sourceMaps","filename","presets","jsx","require","resolve","useBuiltIns","pragma","development","plugins","apis","remove","err","result","code","map","module","exports"],"sources":["../../../../src/utils/webpack/loaders/webpack-remove-exports-loader.ts"],"sourcesContent":["/* eslint-disable @babel/no-invalid-this */\n\nimport { LoaderDefinitionFunction } from \"webpack\"\nimport { transform } from \"@babel/core\"\n\ninterface IOptions {\n  jsx?: boolean\n  remove?: Array<string>\n}\n\nconst webpackRemoveExportsLoader: LoaderDefinitionFunction<IOptions> =\n  function webpackRemoveExportsLoader(source, sourceMap): void {\n    const callback = this.async()\n    const options = this.getOptions()\n\n    transform(\n      source,\n      {\n        babelrc: false,\n        configFile: false,\n        // @ts-ignore inputSourceMap expect object or falsy, but webpack types suggest sourceMap can be a string,\n        // which is not compatibile with babel's transform options\n        inputSourceMap: this.sourceMap ? sourceMap || undefined : undefined,\n        sourceFileName: this.resourcePath,\n        sourceMaps: this.sourceMap,\n        filename: this.resourcePath,\n        presets: options?.jsx\n          ? [\n              [\n                require.resolve(`babel-preset-gatsby/babel-preset-react`),\n                {\n                  useBuiltIns: true,\n                  pragma: `React.createElement`,\n                  // jsx is used only in develop, so for now this is fine\n                  development: true,\n                },\n              ],\n            ]\n          : undefined,\n        plugins: [\n          [\n            require.resolve(`../../babel/babel-plugin-remove-api`),\n            {\n              apis: options?.remove ?? [],\n            },\n          ],\n        ],\n      },\n      (err, result) => {\n        if (err) {\n          callback(err)\n        } else if (result && result.code && result.map) {\n          callback(null, result?.code, result?.map)\n        } else {\n          callback(null, source, sourceMap)\n        }\n      }\n    )\n  }\n\nmodule.exports = webpackRemoveExportsLoader\n"],"mappings":";;AAGA;;AAHA;AAUA,MAAMA,0BAA8D,GAClE,SAASA,0BAAT,CAAoCC,MAApC,EAA4CC,SAA5C,EAA6D;EAAA;;EAC3D,MAAMC,QAAQ,GAAG,KAAKC,KAAL,EAAjB;EACA,MAAMC,OAAO,GAAG,KAAKC,UAAL,EAAhB;EAEA,IAAAC,eAAA,EACEN,MADF,EAEE;IACEO,OAAO,EAAE,KADX;IAEEC,UAAU,EAAE,KAFd;IAGE;IACA;IACAC,cAAc,EAAE,KAAKR,SAAL,GAAiBA,SAAS,IAAIS,SAA9B,GAA0CA,SAL5D;IAMEC,cAAc,EAAE,KAAKC,YANvB;IAOEC,UAAU,EAAE,KAAKZ,SAPnB;IAQEa,QAAQ,EAAE,KAAKF,YARjB;IASEG,OAAO,EAAEX,OAAO,SAAP,IAAAA,OAAO,WAAP,IAAAA,OAAO,CAAEY,GAAT,GACL,CACE,CACEC,OAAO,CAACC,OAAR,CAAiB,wCAAjB,CADF,EAEE;MACEC,WAAW,EAAE,IADf;MAEEC,MAAM,EAAG,qBAFX;MAGE;MACAC,WAAW,EAAE;IAJf,CAFF,CADF,CADK,GAYLX,SArBN;IAsBEY,OAAO,EAAE,CACP,CACEL,OAAO,CAACC,OAAR,CAAiB,qCAAjB,CADF,EAEE;MACEK,IAAI,qBAAEnB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEoB,MAAX,6DAAqB;IAD3B,CAFF,CADO;EAtBX,CAFF,EAiCE,CAACC,GAAD,EAAMC,MAAN,KAAiB;IACf,IAAID,GAAJ,EAAS;MACPvB,QAAQ,CAACuB,GAAD,CAAR;IACD,CAFD,MAEO,IAAIC,MAAM,IAAIA,MAAM,CAACC,IAAjB,IAAyBD,MAAM,CAACE,GAApC,EAAyC;MAC9C1B,QAAQ,CAAC,IAAD,EAAOwB,MAAP,aAAOA,MAAP,uBAAOA,MAAM,CAAEC,IAAf,EAAqBD,MAArB,aAAqBA,MAArB,uBAAqBA,MAAM,CAAEE,GAA7B,CAAR;IACD,CAFM,MAEA;MACL1B,QAAQ,CAAC,IAAD,EAAOF,MAAP,EAAeC,SAAf,CAAR;IACD;EACF,CAzCH;AA2CD,CAhDH;;AAkDA4B,MAAM,CAACC,OAAP,GAAiB/B,0BAAjB"}