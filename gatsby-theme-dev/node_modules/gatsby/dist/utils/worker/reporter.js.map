{"version":3,"file":"reporter.js","names":["initReporterMessagingInMainProcess","workerPool","reporter","_initReporterMessagingInMain","onMessage","bind","gatsbyWorkerMessenger","getMessenger","initReporterMessagingInWorker","isWorker","_initReporterMessagingInWorker","sendMessage","process","on","reason","panic","err"],"sources":["../../../src/utils/worker/reporter.ts"],"sourcesContent":["import reporter from \"gatsby-cli/lib/reporter\"\nimport { GatsbyWorkerPool } from \"./types\"\nimport { isWorker, getMessenger } from \"./messaging\"\n\nexport function initReporterMessagingInMainProcess(\n  workerPool: GatsbyWorkerPool\n): void {\n  if (typeof reporter._initReporterMessagingInMain === `function`) {\n    reporter._initReporterMessagingInMain(workerPool.onMessage.bind(workerPool))\n  }\n}\n\nconst gatsbyWorkerMessenger = getMessenger()\nexport function initReporterMessagingInWorker(): void {\n  if (\n    isWorker &&\n    gatsbyWorkerMessenger &&\n    typeof reporter._initReporterMessagingInWorker === `function`\n  ) {\n    reporter._initReporterMessagingInWorker(\n      gatsbyWorkerMessenger.sendMessage.bind(gatsbyWorkerMessenger)\n    )\n\n    process.on(`unhandledRejection`, (reason: unknown) => {\n      reporter.panic((reason as Error) || `Unhandled rejection`)\n    })\n\n    process.on(`uncaughtException`, function (err) {\n      reporter.panic(err)\n    })\n  }\n}\n"],"mappings":";;;;;;;;AAAA;;AAEA;;AAEO,SAASA,kCAAT,CACLC,UADK,EAEC;EACN,IAAI,OAAOC,iBAAA,CAASC,4BAAhB,KAAkD,UAAtD,EAAiE;IAC/DD,iBAAA,CAASC,4BAAT,CAAsCF,UAAU,CAACG,SAAX,CAAqBC,IAArB,CAA0BJ,UAA1B,CAAtC;EACD;AACF;;AAED,MAAMK,qBAAqB,GAAG,IAAAC,uBAAA,GAA9B;;AACO,SAASC,6BAAT,GAA+C;EACpD,IACEC,mBAAA,IACAH,qBADA,IAEA,OAAOJ,iBAAA,CAASQ,8BAAhB,KAAoD,UAHtD,EAIE;IACAR,iBAAA,CAASQ,8BAAT,CACEJ,qBAAqB,CAACK,WAAtB,CAAkCN,IAAlC,CAAuCC,qBAAvC,CADF;;IAIAM,OAAO,CAACC,EAAR,CAAY,oBAAZ,EAAkCC,MAAD,IAAqB;MACpDZ,iBAAA,CAASa,KAAT,CAAgBD,MAAD,IAAsB,qBAArC;IACD,CAFD;IAIAF,OAAO,CAACC,EAAR,CAAY,mBAAZ,EAAgC,UAAUG,GAAV,EAAe;MAC7Cd,iBAAA,CAASa,KAAT,CAAeC,GAAf;IACD,CAFD;EAGD;AACF"}