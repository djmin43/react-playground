{"version":3,"file":"page-data-helpers.js","names":["constructPageDataString","componentChunkName","matchPath","path","pagePath","staticQueryHashes","manifestId","result","body","JSON","stringify","reverseFixedPagePath","pageDataRequestPath","getPagePathFromPageDataPath","pageDataPath","matches","matchAll","requestedPagePath"],"sources":["../../src/utils/page-data-helpers.ts"],"sourcesContent":["import type { IStructuredError } from \"gatsby-cli/src/structured-errors/types\"\nimport { IGatsbyPage } from \"../redux/types\"\n\nexport interface IPageData {\n  componentChunkName: IGatsbyPage[\"componentChunkName\"]\n  matchPath?: IGatsbyPage[\"matchPath\"]\n  path: IGatsbyPage[\"path\"]\n  staticQueryHashes: Array<string>\n  getServerDataError?: IStructuredError | Array<IStructuredError> | null\n  manifestId?: string\n}\n\nexport function constructPageDataString(\n  {\n    componentChunkName,\n    matchPath,\n    path: pagePath,\n    staticQueryHashes,\n    manifestId,\n  }: IPageData,\n  result: string | Buffer\n): string {\n  let body =\n    `{` +\n    `\"componentChunkName\":\"${componentChunkName}\",` +\n    `\"path\":${JSON.stringify(pagePath)},` +\n    `\"result\":${result},` +\n    `\"staticQueryHashes\":${JSON.stringify(staticQueryHashes)}`\n\n  if (matchPath) {\n    body += `,\"matchPath\":\"${matchPath}\"`\n  }\n\n  if (manifestId) {\n    body += `,\"manifestId\":\"${manifestId}\"`\n  }\n\n  body += `}`\n\n  return body\n}\n\nexport function reverseFixedPagePath(pageDataRequestPath: string): string {\n  return pageDataRequestPath === `index` ? `/` : pageDataRequestPath\n}\n\nexport function getPagePathFromPageDataPath(\n  pageDataPath: string\n): string | null {\n  const matches = pageDataPath.matchAll(\n    /^\\/?page-data\\/(.+)\\/page-data.json$/gm\n  )\n  for (const [, requestedPagePath] of matches) {\n    return reverseFixedPagePath(requestedPagePath)\n  }\n\n  return null\n}\n"],"mappings":";;;;;;;AAYO,SAASA,uBAAT,CACL;EACEC,kBADF;EAEEC,SAFF;EAGEC,IAAI,EAAEC,QAHR;EAIEC,iBAJF;EAKEC;AALF,CADK,EAQLC,MARK,EASG;EACR,IAAIC,IAAI,GACL,GAAD,GACC,yBAAwBP,kBAAmB,IAD5C,GAEC,UAASQ,IAAI,CAACC,SAAL,CAAeN,QAAf,CAAyB,GAFnC,GAGC,YAAWG,MAAO,GAHnB,GAIC,uBAAsBE,IAAI,CAACC,SAAL,CAAeL,iBAAf,CAAkC,EAL3D;;EAOA,IAAIH,SAAJ,EAAe;IACbM,IAAI,IAAK,iBAAgBN,SAAU,GAAnC;EACD;;EAED,IAAII,UAAJ,EAAgB;IACdE,IAAI,IAAK,kBAAiBF,UAAW,GAArC;EACD;;EAEDE,IAAI,IAAK,GAAT;EAEA,OAAOA,IAAP;AACD;;AAEM,SAASG,oBAAT,CAA8BC,mBAA9B,EAAmE;EACxE,OAAOA,mBAAmB,KAAM,OAAzB,GAAmC,GAAnC,GAAwCA,mBAA/C;AACD;;AAEM,SAASC,2BAAT,CACLC,YADK,EAEU;EACf,MAAMC,OAAO,GAAGD,YAAY,CAACE,QAAb,CACd,wCADc,CAAhB;;EAGA,KAAK,MAAM,GAAGC,iBAAH,CAAX,IAAoCF,OAApC,EAA6C;IAC3C,OAAOJ,oBAAoB,CAACM,iBAAD,CAA3B;EACD;;EAED,OAAO,IAAP;AACD"}