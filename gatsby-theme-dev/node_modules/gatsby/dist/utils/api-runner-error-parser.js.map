{"version":3,"file":"api-runner-error-parser.js","names":["errorParser","err","handlers","regex","cb","match","id","context","sourceMessage","arg","structured","errorMessage","Array","isArray","Error","message","matched","error","undefined"],"sources":["../../src/utils/api-runner-error-parser.ts"],"sourcesContent":["import { IMatch } from \"../types\"\n\nconst errorParser = ({ err }: { err: unknown }): IMatch => {\n  const handlers = [\n    {\n      regex: /(.+) is not defined/m,\n      cb: (match: RegExpMatchArray): IMatch => {\n        return {\n          id: `11330`,\n          context: { sourceMessage: match[0], arg: match[1] },\n        }\n      },\n    },\n  ]\n\n  let structured: IMatch | undefined\n  let errorMessage: string | undefined\n\n  // try to handle as many type of err as possible.\n  // the err might come from a plugin so we don't\n  // know what we are getting\n  if (Array.isArray(err)) {\n    err = err[0]\n  }\n  if (err instanceof Error) {\n    errorMessage = err.message\n  }\n  if (typeof err === `string`) {\n    errorMessage = err\n  }\n\n  for (const { regex, cb } of handlers) {\n    const matched = errorMessage?.match(regex)\n    if (matched) {\n      structured = {\n        ...cb(matched),\n      }\n      break\n    }\n  }\n\n  // if we haven't found any known error\n  if (!structured) {\n    return {\n      id: `11321`,\n      context: { sourceMessage: errorMessage || `` },\n      error: err instanceof Error ? err : undefined,\n    }\n  }\n\n  return structured\n}\n\nexport default errorParser\n"],"mappings":";;;;;AAEA,MAAMA,WAAW,GAAG,CAAC;EAAEC;AAAF,CAAD,KAAuC;EACzD,MAAMC,QAAQ,GAAG,CACf;IACEC,KAAK,EAAE,sBADT;IAEEC,EAAE,EAAGC,KAAD,IAAqC;MACvC,OAAO;QACLC,EAAE,EAAG,OADA;QAELC,OAAO,EAAE;UAAEC,aAAa,EAAEH,KAAK,CAAC,CAAD,CAAtB;UAA2BI,GAAG,EAAEJ,KAAK,CAAC,CAAD;QAArC;MAFJ,CAAP;IAID;EAPH,CADe,CAAjB;EAYA,IAAIK,UAAJ;EACA,IAAIC,YAAJ,CAdyD,CAgBzD;EACA;EACA;;EACA,IAAIC,KAAK,CAACC,OAAN,CAAcZ,GAAd,CAAJ,EAAwB;IACtBA,GAAG,GAAGA,GAAG,CAAC,CAAD,CAAT;EACD;;EACD,IAAIA,GAAG,YAAYa,KAAnB,EAA0B;IACxBH,YAAY,GAAGV,GAAG,CAACc,OAAnB;EACD;;EACD,IAAI,OAAOd,GAAP,KAAgB,QAApB,EAA6B;IAC3BU,YAAY,GAAGV,GAAf;EACD;;EAED,KAAK,MAAM;IAAEE,KAAF;IAASC;EAAT,CAAX,IAA4BF,QAA5B,EAAsC;IAAA;;IACpC,MAAMc,OAAO,oBAAGL,YAAH,kDAAG,cAAcN,KAAd,CAAoBF,KAApB,CAAhB;;IACA,IAAIa,OAAJ,EAAa;MACXN,UAAU,GAAG,EACX,GAAGN,EAAE,CAACY,OAAD;MADM,CAAb;MAGA;IACD;EACF,CArCwD,CAuCzD;;;EACA,IAAI,CAACN,UAAL,EAAiB;IACf,OAAO;MACLJ,EAAE,EAAG,OADA;MAELC,OAAO,EAAE;QAAEC,aAAa,EAAEG,YAAY,IAAK;MAAlC,CAFJ;MAGLM,KAAK,EAAEhB,GAAG,YAAYa,KAAf,GAAuBb,GAAvB,GAA6BiB;IAH/B,CAAP;EAKD;;EAED,OAAOR,UAAP;AACD,CAjDD;;eAmDeV,W"}