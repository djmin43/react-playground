{"version":3,"file":"joi.js","names":["stripTrailingSlash","chain","replace","addLeadingSlash","when","Joi","string","uri","relativeOnly","then","gatsbyConfigSchema","object","keys","flags","polyfill","boolean","default","assetPrefix","allowRelative","pathPrefix","allow","linkPrefix","forbidden","error","Error","siteMetadata","siteUrl","unknown","mapping","plugins","array","proxy","items","prefix","required","url","single","partytownProxiedURLs","developMiddleware","func","jsxRuntime","valid","jsxImportSource","trailingSlash","graphqlTypegen","alternatives","typesOutputPath","DEFAULT_TYPES_OUTPUT_PATH","custom","value","pageSchema","path","matchPath","component","componentChunkName","context","pluginCreator___NODE","pluginCreatorId","nodeSchema","id","children","parent","fields","internal","contentDigest","mediaType","type","owner","fieldOwners","content","description","ignoreType","counter","number"],"sources":["../../src/joi-schemas/joi.ts"],"sourcesContent":["import Joi from \"joi\"\nimport { IGatsbyConfig, IGatsbyPage, IGatsbyNode } from \"../redux/types\"\nimport { DEFAULT_TYPES_OUTPUT_PATH } from \"../utils/graphql-typegen/ts-codegen\"\n\nconst stripTrailingSlash = (chain: Joi.StringSchema): Joi.StringSchema =>\n  chain.replace(/(\\w)\\/+$/, `$1`)\n\n// only add leading slash on relative urls\nconst addLeadingSlash = (chain: Joi.StringSchema): Joi.StringSchema =>\n  chain.when(Joi.string().uri({ relativeOnly: true }), {\n    then: chain.replace(/^([^/])/, `/$1`),\n  })\n\nexport const gatsbyConfigSchema: Joi.ObjectSchema<IGatsbyConfig> = Joi.object()\n  .keys({\n    flags: Joi.object(),\n    polyfill: Joi.boolean().default(true),\n    assetPrefix: stripTrailingSlash(\n      Joi.string().uri({\n        allowRelative: true,\n      })\n    ),\n    pathPrefix: addLeadingSlash(\n      stripTrailingSlash(\n        Joi.string()\n          .uri({\n            allowRelative: true,\n            relativeOnly: true,\n          })\n          .default(``)\n          // removes single / value\n          .allow(``)\n          .replace(/^\\/$/, ``)\n      )\n    ),\n    linkPrefix: Joi.forbidden().error(\n      new Error(`\"linkPrefix\" should be changed to \"pathPrefix\"`)\n    ),\n    siteMetadata: Joi.object({\n      siteUrl: stripTrailingSlash(Joi.string()).uri(),\n    }).unknown(),\n    mapping: Joi.object(),\n    plugins: Joi.array(),\n    proxy: Joi.array()\n      .items(\n        Joi.object().keys({\n          prefix: Joi.string().required(),\n          url: Joi.string().required(),\n        })\n      )\n      .single(),\n    partytownProxiedURLs: Joi.array().items(Joi.string()),\n    developMiddleware: Joi.func(),\n    jsxRuntime: Joi.string().valid(`automatic`, `classic`).default(`classic`),\n    jsxImportSource: Joi.string(),\n    trailingSlash: Joi.string()\n      .valid(`always`, `never`, `ignore`, `legacy`) // TODO(v5): Remove legacy\n      .default(`legacy`),\n    graphqlTypegen: Joi.alternatives(\n      Joi.boolean(),\n      Joi.object()\n        .keys({\n          typesOutputPath: Joi.string().default(DEFAULT_TYPES_OUTPUT_PATH),\n        })\n        .unknown(false)\n    )\n      .default(false)\n      .custom(value => {\n        if (value === true) {\n          return {\n            typesOutputPath: DEFAULT_TYPES_OUTPUT_PATH,\n          }\n        }\n\n        return value\n      }),\n  })\n  // throws when both assetPrefix and pathPrefix are defined\n  .when(\n    Joi.object({\n      assetPrefix: Joi.string().uri({\n        allowRelative: true,\n        relativeOnly: true,\n      }),\n      pathPrefix: Joi.string()\n        .uri({\n          allowRelative: true,\n          relativeOnly: true,\n        })\n        .default(``),\n    }),\n    {\n      then: Joi.object({\n        assetPrefix: Joi.string()\n          .uri({\n            allowRelative: false,\n          })\n          .error(\n            new Error(\n              `assetPrefix must be an absolute URI when used with pathPrefix`\n            )\n          ),\n      }),\n    }\n  )\n\nexport const pageSchema: Joi.ObjectSchema<IGatsbyPage> = Joi.object()\n  .keys({\n    path: Joi.string().required(),\n    matchPath: Joi.string(),\n    component: Joi.string().required(),\n    componentChunkName: Joi.string().required(),\n    context: Joi.object(),\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    pluginCreator___NODE: Joi.string(),\n    pluginCreatorId: Joi.string(),\n  })\n  .unknown()\n\nexport const nodeSchema: Joi.ObjectSchema<IGatsbyNode> = Joi.object()\n  .keys({\n    id: Joi.string().required(),\n    children: Joi.array().items(Joi.string(), Joi.object().forbidden()),\n    parent: Joi.string().allow(null),\n    fields: Joi.object(),\n    internal: Joi.object()\n      .keys({\n        contentDigest: Joi.string().required(),\n        mediaType: Joi.string(),\n        type: Joi.string().required(),\n        owner: Joi.string().required(),\n        fieldOwners: Joi.object(),\n        content: Joi.string().allow(``),\n        description: Joi.string(),\n        ignoreType: Joi.boolean(),\n        counter: Joi.number(),\n      })\n      .unknown(false), // Don't allow non-standard fields\n  })\n  .unknown()\n"],"mappings":"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"}