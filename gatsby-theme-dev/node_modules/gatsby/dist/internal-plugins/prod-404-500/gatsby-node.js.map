{"version":3,"file":"gatsby-node.js","names":["emitter","store","require","actions","originalStatusPageByStatus","originalStatusPageByPath","on","action","result","exec","payload","path","length","status","originalPage","storedPage","component","context","dispatch","createPage","plugin","deletePage"],"sources":["../../../src/internal-plugins/prod-404-500/gatsby-node.js"],"sourcesContent":["const { emitter, store } = require(`../../redux`)\nconst { actions } = require(`../../redux/actions`)\n\nconst originalStatusPageByStatus = {}\nconst originalStatusPageByPath = {}\n\nemitter.on(`CREATE_PAGE`, action => {\n  // Copy /404/ to /404.html and /500/ to /500.html. Many static site hosts expect\n  // site 404 pages to be named this. In addition, with Rendering Engines there might\n  // be runtime errors which would fallback to \"/500.html\" page.\n  // https://www.gatsbyjs.com/docs/how-to/adding-common-features/add-404-page/\n  const result = /^\\/?(404|500)\\/?$/.exec(action.payload.path)\n  if (result && result.length > 1) {\n    const status = result[1]\n\n    const originalPage = originalStatusPageByStatus[status]\n\n    if (!originalPage) {\n      const storedPage = {\n        path: action.payload.path,\n        component: action.payload.component,\n        context: action.payload.context,\n        status,\n      }\n\n      originalStatusPageByStatus[status] = storedPage\n      originalStatusPageByPath[action.payload.path] = storedPage\n\n      store.dispatch(\n        actions.createPage(\n          {\n            ...storedPage,\n            path: `/${status}.html`,\n          },\n          action.plugin,\n          action\n        )\n      )\n    }\n  }\n})\n\nemitter.on(`DELETE_PAGE`, action => {\n  const storedPage = originalStatusPageByPath[action.payload.path]\n  if (storedPage) {\n    store.dispatch(\n      actions.deletePage({\n        ...storedPage,\n        path: `/${storedPage.status}.html`,\n      })\n    )\n    originalStatusPageByPath[action.payload.path] = null\n    originalStatusPageByStatus[storedPage.status] = null\n  }\n})\n"],"mappings":";;AAAA,MAAM;EAAEA,OAAF;EAAWC;AAAX,IAAqBC,OAAO,CAAE,aAAF,CAAlC;;AACA,MAAM;EAAEC;AAAF,IAAcD,OAAO,CAAE,qBAAF,CAA3B;;AAEA,MAAME,0BAA0B,GAAG,EAAnC;AACA,MAAMC,wBAAwB,GAAG,EAAjC;AAEAL,OAAO,CAACM,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;EAClC;EACA;EACA;EACA;EACA,MAAMC,MAAM,GAAG,oBAAoBC,IAApB,CAAyBF,MAAM,CAACG,OAAP,CAAeC,IAAxC,CAAf;;EACA,IAAIH,MAAM,IAAIA,MAAM,CAACI,MAAP,GAAgB,CAA9B,EAAiC;IAC/B,MAAMC,MAAM,GAAGL,MAAM,CAAC,CAAD,CAArB;IAEA,MAAMM,YAAY,GAAGV,0BAA0B,CAACS,MAAD,CAA/C;;IAEA,IAAI,CAACC,YAAL,EAAmB;MACjB,MAAMC,UAAU,GAAG;QACjBJ,IAAI,EAAEJ,MAAM,CAACG,OAAP,CAAeC,IADJ;QAEjBK,SAAS,EAAET,MAAM,CAACG,OAAP,CAAeM,SAFT;QAGjBC,OAAO,EAAEV,MAAM,CAACG,OAAP,CAAeO,OAHP;QAIjBJ;MAJiB,CAAnB;MAOAT,0BAA0B,CAACS,MAAD,CAA1B,GAAqCE,UAArC;MACAV,wBAAwB,CAACE,MAAM,CAACG,OAAP,CAAeC,IAAhB,CAAxB,GAAgDI,UAAhD;MAEAd,KAAK,CAACiB,QAAN,CACEf,OAAO,CAACgB,UAAR,CACE,EACE,GAAGJ,UADL;QAEEJ,IAAI,EAAG,IAAGE,MAAO;MAFnB,CADF,EAKEN,MAAM,CAACa,MALT,EAMEb,MANF,CADF;IAUD;EACF;AACF,CAlCD;AAoCAP,OAAO,CAACM,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;EAClC,MAAMQ,UAAU,GAAGV,wBAAwB,CAACE,MAAM,CAACG,OAAP,CAAeC,IAAhB,CAA3C;;EACA,IAAII,UAAJ,EAAgB;IACdd,KAAK,CAACiB,QAAN,CACEf,OAAO,CAACkB,UAAR,CAAmB,EACjB,GAAGN,UADc;MAEjBJ,IAAI,EAAG,IAAGI,UAAU,CAACF,MAAO;IAFX,CAAnB,CADF;IAMAR,wBAAwB,CAACE,MAAM,CAACG,OAAP,CAAeC,IAAhB,CAAxB,GAAgD,IAAhD;IACAP,0BAA0B,CAACW,UAAU,CAACF,MAAZ,CAA1B,GAAgD,IAAhD;EACD;AACF,CAZD"}