{"version":3,"file":"actions.js","names":["flushPageData","context","enqueueFlush","parentSpan","assignDirtyQueries","assign","_context","data","queryIds","markSourceFilesDirty","filesDirty","markSourceFilesClean","trackRequestedQueryRun","pendingQueryRuns","payload","Set","pagePath","add","clearCurrentlyHandledPendingQueryRuns","currentlyHandledPendingQueryRuns","undefined","queryActions"],"sources":["../../../src/state-machines/query-running/actions.ts"],"sourcesContent":["import { IQueryRunningContext } from \"./types\"\nimport {\n  DoneInvokeEvent,\n  assign,\n  ActionFunctionMap,\n  AnyEventObject,\n} from \"xstate\"\nimport { enqueueFlush } from \"../../utils/page-data\"\n\nexport const flushPageData = (context: IQueryRunningContext): void => {\n  enqueueFlush(context.parentSpan)\n}\n\nexport const assignDirtyQueries = assign<\n  IQueryRunningContext,\n  DoneInvokeEvent<any>\n>((_context, { data }) => {\n  const { queryIds } = data\n  return {\n    queryIds,\n  }\n})\n\nexport const markSourceFilesDirty = assign<IQueryRunningContext>({\n  filesDirty: true,\n})\n\nexport const markSourceFilesClean = assign<IQueryRunningContext>({\n  filesDirty: false,\n})\n\nexport const trackRequestedQueryRun = assign<\n  IQueryRunningContext,\n  AnyEventObject\n>({\n  pendingQueryRuns: (context, { payload }) => {\n    const pendingQueryRuns = context.pendingQueryRuns || new Set<string>()\n    if (payload?.pagePath) {\n      pendingQueryRuns.add(payload.pagePath)\n    }\n    return pendingQueryRuns\n  },\n})\n\nexport const clearCurrentlyHandledPendingQueryRuns =\n  assign<IQueryRunningContext>({\n    currentlyHandledPendingQueryRuns: undefined,\n  })\n\nexport const queryActions: ActionFunctionMap<IQueryRunningContext, any> = {\n  assignDirtyQueries,\n  flushPageData,\n  markSourceFilesDirty,\n  markSourceFilesClean,\n  trackRequestedQueryRun,\n  clearCurrentlyHandledPendingQueryRuns,\n}\n"],"mappings":";;;;;AACA;;AAMA;;AAEO,MAAMA,aAAa,GAAIC,OAAD,IAAyC;EACpE,IAAAC,sBAAA,EAAaD,OAAO,CAACE,UAArB;AACD,CAFM;;;AAIA,MAAMC,kBAAkB,GAAG,IAAAC,cAAA,EAGhC,CAACC,QAAD,EAAW;EAAEC;AAAF,CAAX,KAAwB;EACxB,MAAM;IAAEC;EAAF,IAAeD,IAArB;EACA,OAAO;IACLC;EADK,CAAP;AAGD,CARiC,CAA3B;;AAUA,MAAMC,oBAAoB,GAAG,IAAAJ,cAAA,EAA6B;EAC/DK,UAAU,EAAE;AADmD,CAA7B,CAA7B;;AAIA,MAAMC,oBAAoB,GAAG,IAAAN,cAAA,EAA6B;EAC/DK,UAAU,EAAE;AADmD,CAA7B,CAA7B;;AAIA,MAAME,sBAAsB,GAAG,IAAAP,cAAA,EAGpC;EACAQ,gBAAgB,EAAE,CAACZ,OAAD,EAAU;IAAEa;EAAF,CAAV,KAA0B;IAC1C,MAAMD,gBAAgB,GAAGZ,OAAO,CAACY,gBAAR,IAA4B,IAAIE,GAAJ,EAArD;;IACA,IAAID,OAAJ,aAAIA,OAAJ,eAAIA,OAAO,CAAEE,QAAb,EAAuB;MACrBH,gBAAgB,CAACI,GAAjB,CAAqBH,OAAO,CAACE,QAA7B;IACD;;IACD,OAAOH,gBAAP;EACD;AAPD,CAHoC,CAA/B;;AAaA,MAAMK,qCAAqC,GAChD,IAAAb,cAAA,EAA6B;EAC3Bc,gCAAgC,EAAEC;AADP,CAA7B,CADK;;AAKA,MAAMC,YAA0D,GAAG;EACxEjB,kBADwE;EAExEJ,aAFwE;EAGxES,oBAHwE;EAIxEE,oBAJwE;EAKxEC,sBALwE;EAMxEM;AANwE,CAAnE"}