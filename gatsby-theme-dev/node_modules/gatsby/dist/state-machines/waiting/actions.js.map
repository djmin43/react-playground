{"version":3,"file":"actions.js","names":["callApi","store","event","callRealApi","payload","addNodeMutation","assign","nodeMutationBatch","push","extractQueries","sendParent","waitingActions"],"sources":["../../../src/state-machines/waiting/actions.ts"],"sourcesContent":["import {\n  AssignAction,\n  assign,\n  ActionFunctionMap,\n  sendParent,\n  AnyEventObject,\n  ActionFunction,\n} from \"xstate\"\nimport { IWaitingContext } from \"./types\"\nimport { AnyAction } from \"redux\"\nimport { callRealApi } from \"../../utils/call-deferred-api\"\n\nexport const callApi: ActionFunction<IWaitingContext, AnyEventObject> = (\n  { store },\n  event\n) => callRealApi(event.payload, store)\n\n/**\n * Event handler used when we're not ready to process node mutations.\n * Instead we add it to a batch to process when we're next idle\n */\nexport const addNodeMutation: AssignAction<IWaitingContext, AnyAction> = assign(\n  {\n    nodeMutationBatch: ({ nodeMutationBatch = [] }, { payload }) => {\n      // It's not pretty, but it's much quicker than concat\n      nodeMutationBatch.push(payload)\n      return nodeMutationBatch\n    },\n  }\n)\n\nexport const extractQueries = sendParent<IWaitingContext, AnyEventObject>(\n  `EXTRACT_QUERIES_NOW`\n)\n\nexport const waitingActions: ActionFunctionMap<IWaitingContext, AnyAction> = {\n  addNodeMutation,\n  extractQueries,\n  callApi,\n}\n"],"mappings":";;;;;AAAA;;AAUA;;AAEO,MAAMA,OAAwD,GAAG,CACtE;EAAEC;AAAF,CADsE,EAEtEC,KAFsE,KAGnE,IAAAC,4BAAA,EAAYD,KAAK,CAACE,OAAlB,EAA2BH,KAA3B,CAHE;AAKP;AACA;AACA;AACA;;;;AACO,MAAMI,eAAyD,GAAG,IAAAC,cAAA,EACvE;EACEC,iBAAiB,EAAE,CAAC;IAAEA,iBAAiB,GAAG;EAAtB,CAAD,EAA6B;IAAEH;EAAF,CAA7B,KAA6C;IAC9D;IACAG,iBAAiB,CAACC,IAAlB,CAAuBJ,OAAvB;IACA,OAAOG,iBAAP;EACD;AALH,CADuE,CAAlE;;AAUA,MAAME,cAAc,GAAG,IAAAC,kBAAA,EAC3B,qBAD2B,CAAvB;;AAIA,MAAMC,cAA6D,GAAG;EAC3EN,eAD2E;EAE3EI,cAF2E;EAG3ET;AAH2E,CAAtE"}